window.ss=window.ss||{views:{},models:{},controllers:{},rounter:null},window.ss.views.App=Backbone.View.extend({el:".js-app",nameInput:!1,phoneInput:!1,activeMenu:null,newActiveMenu:null,mobileMenuStep:0,events:function(){return Modernizr.touch?{"click .js-menu":"showHideTouch","click .js-menuShow":"showHideTouch","click .js-search-field":"resizeSearch","click .js-showReview":"reviewShow","click .js-sendReview":"reviewHide","click .js-order":"showPopup","click .js-wishBtnCheckbox":"wish","click .js-cancelWish":"cancelWish","click .js-next-buton":"webkitIt","click .js-orderSend":"sendOrder","click .js-orderCancel":"orderCancel","keyup .js-inputName":"changeName","keydown .js-inputPhone":"changePhone","input .js-inputPhone":"validatePhone","click .js-closePopup":"closeFancybox","click .js-mobileMenuToggle":"toggleMobileMenu","click .js-mobileFirstItem":"toggleFirstLayerMenu","click .js-mobileBtn":"stepBack"}:{"click .js-menuShow":"preventDef","mouseenter .js-menu":"showHideMenu","mouseleave .js-menu":"showHideMenu","mouseenter .js-menuShow":"showHideMenu","mouseleave .js-menuShow":"showHideMenu","click .js-search-field":"resizeSearch","click .js-showReview":"reviewShow","click .js-sendReview":"reviewHide","click .js-order":"showPopup","click .js-wishBtnCheckbox":"wish","click .js-cancelWish":"cancelWish","click .js-next-buton":"webkitIt","click .js-orderSend":"sendOrder","click .js-orderCancel":"orderCancel","keyup .js-inputName":"changeName","keydown .js-inputPhone":"changePhone","input .js-inputPhone":"validatePhone","click .js-closePopup":"closeFancybox","click .js-mobileMenuToggle":"toggleMobileMenu","click .js-mobileFirstItem":"toggleFirstLayerMenu","click .js-mobileBtn":"stepBack","click .js-menuShow":"showMobilemenu"}},showMobilemenu:function(e){var s=e.currentTarget.attributes.href.nodeValue;!$(".js-mobileMenuToggle").hasClass("active")&&$(window).width()<=570&&($(".js-mobileMenuToggle").click(),$(".js-mobileFirstList").find(".js-mobileFirstItem.active").length>0&&$(".js-mobileFirstItem.active").click(),$('.js-mobileFirstItem[name="'+s+'"').click())},stepBack:function(e){$(e.currentTarget);1===this.mobileMenuStep&&$(".js-mobileMenu").find(".js-mobileFirstItem.active").click(),2===this.mobileMenuStep&&$(".js-mobileMenu").find(".js-mobileSecondItem.active").click()},toggleFirstLayerMenu:function(e){var s=$(e.target),t=$(e.target).parent(),a=this;s.hasClass("active")||s.parent().hasClass("active")?((s.hasClass("js-mobileFirstItem")||s.parent().hasClass("js-mobileFirstItem"))&&(a.mobileMenuStep=0,$(".js-mobileBtn").removeClass("active"),$(".js-mobileTitle").removeClass("disabled"),$(".js-mobileFirstItem").removeClass("disabled").removeClass("active"),s.parent().hasClass("js-mobileFirstItem")?s.parent().removeClass("active"):s.removeClass("active")),(s.hasClass("js-mobileSecondItem")||s.parent().hasClass("js-mobileSecondItem"))&&(a.mobileMenuStep=1,$(".js-mobileSecondItem").removeClass("disabled"),s.parent().hasClass("js-mobileSecondItem")?s.parent().removeClass("active"):s.removeClass("active"))):((s.hasClass("js-mobileFirstItem")||s.parent().hasClass("js-mobileFirstItem"))&&(a.mobileMenuStep=1,$(".js-mobileBtn").addClass("active"),$(".js-mobileTitle").addClass("disabled"),s.parent().hasClass("js-mobileFirstItem")?(t=s.closest(".js-mobileFirstList"),s.parent().addClass("active")):s.addClass("active"),t.find(".js-mobileFirstItem").each(function(e,s){$(s).hasClass("active")||$(s).addClass("disabled")})),(s.hasClass("js-mobileSecondItem")||s.parent().hasClass("js-mobileSecondItem"))&&(a.mobileMenuStep=2,s.parent().hasClass("js-mobileSecondItem")?(t=s.closest(".js-mobileFirstList"),s.parent().addClass("active")):s.addClass("active"),t.find(".js-mobileSecondItem").each(function(e,s){$(s).hasClass("active")||$(s).addClass("disabled")})))},toggleMobileMenu:function(e){var s=($(".js-mobileMenu"),$(e.currentTarget)),t=$(".site-container");s.hasClass("active")?(s.removeClass("active"),t.removeClass("slided")):(s.addClass("active"),t.addClass("slided"))},showHideTouch:function(e){var s=$(".js-dropdown"),t=$(".js-mask"),a=this;if($(".js-search-field").removeClass("expand"),$(e.currentTarget).hasClass("js-menuShow")){var i=e.currentTarget.attributes.href.nodeValue,n=$(e.currentTarget),l=s.find('.js-dropdown-container[data-type="'+i+'"]');a.activeMenu=i,$(".js-menuShow").removeClass("active"),n.addClass("active"),$(".js-dropdown-container").removeClass("active"),l.addClass("active"),!$(".js-mobileMenuToggle").hasClass("active")&&$(window).width()<=570&&($(".js-mobileMenuToggle").click(),$(".js-mobileFirstList").find(".js-mobileFirstItem.active").length>0&&$(".js-mobileFirstItem.active").click(),$('.js-mobileFirstItem[name="'+i+'"').click())}else $(e.currentTarget).hasClass("js-menu")&&(s.hasClass("active")?a.newActiveMenu===a.activeMenu?(s.removeClass("active"),t.removeClass("active"),$(".js-menuShow").removeClass("active")):a.newActiveMenu=a.activeMenu:(a.newActiveMenu=a.activeMenu,s.addClass("active"),t.addClass("active")))},showHideMenu:function(e){var s=$(".js-dropdown"),t=$(".js-mask");if($(".js-search-field").removeClass("expand"),$(e.currentTarget).hasClass("js-menu"))s.hasClass("active")?(s.removeClass("active"),t.removeClass("active"),$(".js-menuShow").removeClass("active")):(s.addClass("active"),t.addClass("active"));else if($(e.currentTarget).hasClass("js-menuShow")){e.preventDefault();var a=e.currentTarget.attributes.href.nodeValue,i=$(e.currentTarget),n=s.find('.js-dropdown-container[data-type="'+a+'"]');$(".js-menuShow").removeClass("active"),i.addClass("active"),$(".js-dropdown-container").removeClass("active"),n.addClass("active")}},closeFancybox:function(e){e.preventDefault(),$.fancybox.close()},changeName:function(e){var s=$(e.currentTarget);this.nameInput=0==s.val().length?!1:!0},validatePhone:function(e){var s=$(e.currentTarget);isNaN(s.val())?(s.removeClass("validate"),e.preventDefault(),this.phoneInput=!1,_.delay(function(){s.val("")},300)):11==s.val().length?(s.addClass("validate"),this.phoneInput=!0):(s.removeClass("validate"),this.phoneInput=!1)},changePhone:function(e){var s=$(e.currentTarget).val(),t=e.which?e.which:e.keyCode;return(48>t||t>57||s.length>10)&&8!==t?(e.preventDefault(),!1):void 0},sendOrder:function(e){e.preventDefault();var s=$(e.currentTarget).closest(".js-orderContainer"),t=s.find(".js-order-form").serialize();this.nameInput&&this.phoneInput&&$.ajax({type:"POST",url:"#",data:t,success:function(){s.find(".js-step1").removeClass("active"),s.find(".js-popupName").text(s.find(".js-inputName").val()),s.find(".js-congratContainer").addClass("active"),s.find(".js-phoneTime").text(s.find(".js-callHours").val()+":"+s.find(".js-callMinutes").val()),_.delay(function(){$.fancybox.resize},2e3)}})},orderCancel:function(e){e.preventDefault(),$(e.currentTarget).closest(".js-orderContainer").find(".js-order-form")[0].reset()},reviewShow:function(e){$(e.currentTarget).hide(),$(".js-review").addClass("active")},reviewHide:function(e){e.preventDefault(),$(".js-showReview").show(),$(".js-review").removeClass("active")},bodyFunc:function(e){$(e.target.offsetParent).parents(".js-search-field").length||$(e.target).hasClass("js-listItem")||$(".js-search-field").removeClass("expand")},resizeSearch:function(e){$(e.currentTarget).addClass("expand")},preventDef:function(e){e.preventDefault()},cancelWish:function(e){e.preventDefault(),$(e.currentTarget).closest(".js-product").find(".js-wishBtnCheckbox").trigger("click")},progressTimer:function(){},setActiveSlide:function(){},wish:function(e){var s=$(e.currentTarget);s.is(":checked")?(s.closest(".js-wishBtn").addClass("checked"),s.parents(".js-product").find(".js-wishBlock").addClass("show")):(s.closest(".js-wishBtn").removeClass("checked"),s.parents(".js-product").find(".js-wishBlock").removeClass("show"))},fancybox:function(){$(".js-fancybox").fancybox({padding:0,tpl:{wrap:'<div class="fancybox-wrap" tabIndex="-1"><div class="fancybox-skin"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div></div>',image:'<img class="fancybox-image" src="{href}" alt="" />',iframe:'<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0"></iframe>',error:'<p class="fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',closeBtn:'<a title="Close" class="fancybox-item fancybox-close" href="javascript:;"><svg class="icon_close_thin"><use xlink:href="/img/icons.svg#close_thin" /></svg></a>',next:'<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span></span></a>',prev:'<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span></span></a>'}})},showPopup:function(e){e.preventDefault();var s=($(e.currentTarget),$(e.currentTarget).attr("data-id"));$(".js-orderProduct").attr("value",s),(new Date).getUTCHours()+3>=9&&(new Date).getUTCHours()+3<21?($(".order-popup__category").removeClass("active"),$(".order-popup__online").addClass("active")):($(".order-popup__category").removeClass("active"),$(".order-popup__offline").addClass("active")),$.fancybox.update()},order:function(){var e=this;$(".js-order").fancybox({padding:0,tpl:{wrap:'<div class="fancybox-wrap" tabIndex="-1"><div class="fancybox-skin fancybox-skin_white"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div></div>',closeBtn:'<a title="Close" class="fancybox-item fancybox-close js-orderCancel" href="javascript:;"><svg class="icon_close_thin"><use xlink:href="/img/icons.svg#close_small" /></svg></a>'},beforeShow:function(){$("#buy-popup").addClass("active")},afterShow:function(){$(".js-callHours, .js-callMinutes").selectmenu("refresh")},afterClose:function(){$("#buy-popup").removeClass("active"),$("body").find(".js-inputName").val(""),$("body").find(".js-inputPhone").val(""),$("body").find(".js-callHours").prop("selectedIndex",0),$("body").find(".js-callMinutes").prop("selectedIndex",0),$("body").find(".js-step1").addClass("active"),$("body").find(".js-congratContainer").removeClass("active"),$("body").find(".js-popupName").text(""),$("body").find(".js-phoneTime").text(""),$("body").find(".js-inputPhone").removeClass("validate"),e.nameInput=!1,e.phoneInput=!1}})},initialize:function(){this.views={},this.$(".js-rating").barrating("show",{showSelectedRating:!0,reverse:!1,readonly:!0}),this.progressTimer(),this.render(),this.$el.hasClass("home")&&(this.views.carousel=new window.ss.views.Carousel({refreshTimeout:2e3})),this.$el.hasClass("product-page")&&(this.views.gallery=new window.ss.views.Gallery({})),this.$el.hasClass("catalog")&&(this.views.gallery=new window.ss.views.Catalog({})),this.fancybox(),this.order(),this.customSelect(),$("body").bind("click",this.bodyFunc),$(window).on("resize",_.debounce(function(){$(".js-mobileMenuToggle").hasClass("active")&&$(".js-mobileMenuToggle").click()},200))},webkitIt:function(e){e.preventDefault();var s=$(e.currentTarget),t=s.closest(".js-slide"),a=parseInt(t.attr("data-slide")),i=s.closest(".js-webkitContainer").find(".js-slide").length,n=null,l=s.closest(".js-webkitContainer").find(".js-next-buton");s.hasClass("disabled")||(t.removeClass("active"),n=$(a+1>i?".js-slide[data-slide='1']":".js-slide[data-slide='"+(a+1)+"']"),_.delay(function(){n.addClass("active")},150),l.addClass("disabled"),_.delay(function(){n.addClass("even").removeClass("odd"),t.addClass("odd").removeClass("even"),l.removeClass("disabled")},1e3))},customSelect:function(){$(".js-callHours, .js-callMinutes").selectmenu({icons:{button:"custom-triangle"}})},render:function(){}}),window.ss.views.Carousel=Backbone.View.extend({el:".js-carousel",events:{"click .js-carouselLink":"changeSlideClick"},initialize:function(){this.currentItem=0,this.$links=this.$(".js-carouselLink"),this.$slideHolder=this.$(".js-carouselSlides"),this.$items=this.$(".js-carouselItem"),this.timeout=0,this.$el.attr("data-autorefresh")&&this.restartTimer()},changeSlideClick:function(e){e.preventDefault(),this.currentItem=$(e.currentTarget).parent().index(),this.changeSlide()},changeSlide:function(){this.currentItem=this.currentItem>=this.$links.length?0:this.currentItem,this.$links.filter(".active").removeClass("active"),this.$links.eq(this.currentItem).addClass("active"),this.$slideHolder.transition({y:350*-this.currentItem}),this.restartTimer()},restartTimer:function(){clearTimeout(this.timeout),this.timeout=setTimeout(this.nextSlide.bind(this),5e3)},nextSlide:function(){this.currentItem+=1,this.changeSlide()}}),window.ss.views.Catalog=Backbone.View.extend({el:".js-catalog",events:{"click .js-sort":"sort","click .js-showFilter":"showFilter","click .js-hideFilters":"hideFilters"},sort:function(){},hideFilters:function(){$(".js-showFilter").click()},showFilter:function(e){var s=$(e.target);s.hasClass("active")?(s.removeClass("active"),$(".js-filterContainer").removeClass("active"),$(".js-filter").removeClass("active")):(s.addClass("active"),$(".js-filterContainer").addClass("active"),$(".js-filter").addClass("active"))},initialize:function(){$("#slider-range").slider({range:!0,min:0,max:2e5,values:[0,2e5],slide:function(e,s){$("#costFrom").val(s.values[0]),$("#costTo").val(s.values[1])}})}}),window.ss.views.Gallery=Backbone.View.extend({el:".js-gallery",events:{"click .js-listItem":"showImage"},initialize:function(){var e=this;setInterval(function(){if(parseInt($(e.el).find(".js-listItem.active").index())+1!==parseInt($(e.el).find(".js-listItem").length)){var s=parseInt($(e.el).find(".js-listItem.active").index())+2;$('.js-listItem[data-slideId="'+s+'"]').trigger("click")}else $(".js-listItem").eq(0).trigger("click")},1e4)},showImage:function(e){e.preventDefault();var s=$(e.currentTarget),t=parseInt($(e.currentTarget).attr("data-slideId"));$(".js-listItem.active").removeClass("active"),s.addClass("active"),$(".js-fancybox").fadeOut(),$(this.el).find('.js-fancybox[data-slideId="'+t+'"]').fadeIn()}}),window.ss.views.Order=Backbone.View.extend({el:".js-orderPopup",events:{"click .js-sort":"sort"},initialize:function(){}}),$(function(){function e(){}function s(e){e.data==YT.PlayerState.PLAYING?a.addClass("activated"):a.removeClass("activated")}if(window.ssApp=new window.ss.views.App,$(".js-video-container")){var t,a=$(".js-video-container"),i=$("#player").attr("data-src");window.onYouTubeIframeAPIReady=function(){t=new YT.Player("player",{height:"390",width:"640",videoId:i,events:{onReady:e,onStateChange:s}})}}});